<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Gestion Produits</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial; background: #f4f7f9; padding: 10px; color: #333; display: flex; flex-direction: column; align-items: center; }
h2 { text-align: center; margin: 15px 0; }
input, button { padding: 8px; margin: 5px; border-radius: 5px; border: 1px solid #ccc; }
button { cursor: pointer; background: #2ecc71; color: #fff; border: none; }
button:hover { background: #27ae60; }
.card { background: #fff; padding: 10px; margin: 5px 0; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); width: 90%; }
</style>
</head>
<body>

<h2>Gestion Produits</h2>

<div>
<input id="codeInput" placeholder="Code produit">
<input id="nameInput" placeholder="Nom produit">
<input id="expiryInput" placeholder="Date (DD/MM/YYYY)">
<input id="quantityInput" type="number" placeholder="Quantité">
<button id="addButton">Ajouter</button>
<button id="downloadBtn">Télécharger CSV</button>
</div>

<div id="cardsContainer"></div>

<script>
let products = JSON.parse(localStorage.getItem("products")) || [];

// إضافة منتوج
document.getElementById("addButton").addEventListener("click", function(){
    const code = document.getElementById("codeInput").value.trim();
    const name = document.getElementById("nameInput").value.trim();
    const expiry = document.getElementById("expiryInput").value.trim();
    const quantity = document.getElementById("quantityInput").value.trim();

    if(!code || !name || !expiry || !quantity){ alert("Remplissez tous les champs!"); return; }

    products.push({code,name,expiry,quantity});
    localStorage.setItem("products", JSON.stringify(products));

    document.getElementById("codeInput").value = "";
    document.getElementById("nameInput").value = "";
    document.getElementById("expiryInput").value = "";
    document.getElementById("quantityInput").value = "";

    renderCards();
});

// عرض المنتجات
function renderCards(){
    const container = document.getElementById("cardsContainer");
    container.innerHTML = "";
    products.forEach((p, i)=>{
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
            <strong>${p.name}</strong> (${p.code})<br>
            Date: ${p.expiry} | Quantité: ${p.quantity}<br>
            <button onclick="deleteProduct(${i})">Supprimer</button>
        `;
        container.appendChild(div);
    });
}
function deleteProduct(i){
    products.splice(i,1);
    localStorage.setItem("products", JSON.stringify(products));
    renderCards();
}

// تنزيل CSV
document.getElementById("downloadBtn").addEventListener("click", function(){
    if(products.length===0){ alert("Aucun produit!"); return; }
    let csv = "Code,Nom,Date,Quantité\n";
    products.forEach(p => { csv += `${p.code},${p.name},${p.expiry},${p.quantity}\n`; });

    const blob = new Blob([csv], {type: 'text/csv'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "produits.csv";
    a.click();
    URL.revokeObjectURL(url);
});

renderCards();
</script>

</body>
</html>
